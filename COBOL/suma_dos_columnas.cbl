IDENTIFICATION DIVISION.
PROGRAM-ID. SumaDosColumnas.
AUTHOR. Grok.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT ARCHIVO-ENTRADA ASSIGN TO 'DATOS.DAT'
        ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  ARCHIVO-ENTRADA.
01  REGISTRO-ENTRADA.
    05 NUMERO-COL1        PIC S9(10)V9(2).
    05 FILLER             PIC X VALUE SPACE.
    05 NUMERO-COL2        PIC S9(10)V9(2).

WORKING-STORAGE SECTION.
01  TOTAL-COL1            PIC S9(12)V9(2) VALUE ZERO.
01  TOTAL-COL2            PIC S9(12)V9(2) VALUE ZERO.
01  EOF-INDICADOR         PIC X VALUE 'N'.
01  LINEA-SALIDA-COL1.
    05 FILLER             PIC X(20) VALUE 'TOTAL COLUMNA 1: '.
    05 TOTAL-SALIDA-COL1  PIC -ZZ,ZZZ,ZZZ,ZZ9.99.
01  LINEA-SALIDA-COL2.
    05 FILLER             PIC X(20) VALUE 'TOTAL COLUMNA 2: '.
    05 TOTAL-SALIDA-COL2  PIC -ZZ,ZZZ,ZZZ,ZZ9.99.

PROCEDURE DIVISION.
MAIN-PROCEDURE.
    OPEN INPUT ARCHIVO-ENTRADA.
    PERFORM LEER-Y-SUMAR UNTIL EOF-INDICADOR = 'Y'.
    CLOSE ARCHIVO-ENTRADA.
    MOVE TOTAL-COL1 TO TOTAL-SALIDA-COL1.
    MOVE TOTAL-COL2 TO TOTAL-SALIDA-COL2.
    DISPLAY LINEA-SALIDA-COL1.
    DISPLAY LINEA-SALIDA-COL2.
    STOP RUN.

LEER-Y-SUMAR.
    READ ARCHIVO-ENTRADA
        AT END
            MOVE 'Y' TO EOF-INDICADOR
        NOT AT END
            ADD NUMERO-COL1 TO TOTAL-COL1
            ADD NUMERO-COL2 TO TOTAL-COL2
    END-READ.

END PROGRAM SumaDosColumnas.
