# Ejemplo de Input File de LAMMPS para Green-Kubo (kappa.in)
# Argón Sólido (Lennard-Jones)

# 1. Inicialización
units           metal             # Unidades típicas para sólidos
atom_style      atomic
dimension       3
boundary        p p p             # Condiciones de contorno periódicas

# 2. Definición del sistema (Ejemplo: Argón con densidad y tamaño)
lattice         fcc 5.26          # Constante de red del Argón sólido a baja T
region          box block 0 10 0 10 0 10 # 10x10x10 celdas unitarias
create_box      1 box
create_atoms    1 box

# 3. Potencial (Lennard-Jones para Argón)
mass            1 39.948          # Masa atómica del Argón
pair_style      lj/cut 10.0
pair_coeff      1 1 0.0103231 3.405 # epsilon (eV), sigma (A)

# 4. Equilibrio (Relajación a la temperatura deseada, NPT o NVT)
velocity        all create 80.0 12345 mom yes rot no  # Inicializar velocidades a 80 K
fix             1 all npt temp 80.0 80.0 0.1 iso 0.0 0.0 1.0 # Termostato y barostato
timestep        0.001
thermo          1000
run             200000

unfix           1
reset_timestep  0

# 5. Cálculo del Flujo de Calor y DM de Equilibrio (NVE)
# Se usa NVE para DM de Equilibrio para las fluctuaciones del flujo de calor
fix             2 all nve
compute         myFlux all heat/flux              # Calcula el flujo de calor instantáneo
variable        Jx equal c_myFlux[1] / vol       # Componente x del flujo (J/V)
variable        Jy equal c_myFlux[2] / vol       # Componente y del flujo (J/V)
variable        Jz equal c_myFlux[3] / vol       # Componente z del flujo (J/V)
variable        J2 equal (v_Jx*v_Jx + v_Jy*v_Jy + v_Jz*v_Jz) # |J|^2

# Función de Autocorrelación del Flujo de Calor (ACF)
variable p equal 5000
variable s equal 10
variable d equal 10
# $p = 5000 (steps, e.g., 5 ps with dt = 0.001 ps),
# $s = 10 (sample every 10 steps to reduce data size),
# $d = 10 (correlate over 10-step intervals).
Without these, the script will fail to run.
fix             3 all ave/correlate $p $s $d &
                c_myFlux[1] c_myFlux[2] c_myFlux[3] type auto file J0Jt.dat ave running

# p: correlación total (pasos), s: intervalo de muestreo, d: pasos de DM

thermo_style    custom step temp etotal press vol v_J2
thermo          1000
timestep        0.001
run             1000000                             # Simulación larga para la ACF
