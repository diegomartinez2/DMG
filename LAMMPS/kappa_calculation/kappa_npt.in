# Volumen equilibrio P=0 (NPT SEGURO)
variable T equal 80.0
variable dt equal 0.001
variable semilla equal 12345

units metal
atom_style atomic
boundary p p p

read_data AA-supercell-optimized.lmp

neighbor 0.3 nsq  # ← NSQ: NO BINS!
neigh_modify delay 0 every 1 check yes

pair_style chimesFF
#pair_coeff * * params.txt

# ========== NPT LIMITADO ±20% ==========
minimize 1.0e-6 1.0e-8 5000 50000
velocity all create ${T} ${semilla} mom yes rot no

# FIX CLAVE: LIMITE EXPANSIÓN
change_box all x final 0.8 1.2 y final 0.8 1.2 z final 0.8 1.2 units box
change_box all triclinic xy final -0.4 0.4 xz final -0.4 0.4 yz final -0.4 0.4 units box

fix 1 all npt temp ${T} ${T} 0.1 iso 0.0 0.0 20.0  # Pdamp=20ps LENTO
fix_modify 1 press berendsen
timestep ${dt}
thermo_style custom step temp etotal press vol
thermo 500  # MÁS FRECUENTE

run 10000  # ← 10ps = SUFICIENTE para convergencia

# GUARDAR V_EQ
variable V_eq equal vol
print "VOLUMEN EQUILIBRIO P=0: ${V_eq}"
print "T: ${T} V_eq: ${V_eq}" append v_equilibrio.txt
